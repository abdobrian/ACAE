<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "ClientApp\\node_modules\\browserify\\index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> mdeps = <span class="hljs-built_in">require</span>(<span class="hljs-string">'module-deps'</span>);
<span class="hljs-keyword">var</span> depsSort = <span class="hljs-built_in">require</span>(<span class="hljs-string">'deps-sort'</span>);
<span class="hljs-keyword">var</span> bpack = <span class="hljs-built_in">require</span>(<span class="hljs-string">'browser-pack'</span>);
<span class="hljs-keyword">var</span> insertGlobals = <span class="hljs-built_in">require</span>(<span class="hljs-string">'insert-module-globals'</span>);
<span class="hljs-keyword">var</span> syntaxError = <span class="hljs-built_in">require</span>(<span class="hljs-string">'syntax-error'</span>);

<span class="hljs-keyword">var</span> builtins = <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/builtins.js'</span>);

<span class="hljs-keyword">var</span> splicer = <span class="hljs-built_in">require</span>(<span class="hljs-string">'labeled-stream-splicer'</span>);
<span class="hljs-keyword">var</span> through = <span class="hljs-built_in">require</span>(<span class="hljs-string">'through2'</span>);
<span class="hljs-keyword">var</span> concat = <span class="hljs-built_in">require</span>(<span class="hljs-string">'concat-stream'</span>);

<span class="hljs-keyword">var</span> inherits = <span class="hljs-built_in">require</span>(<span class="hljs-string">'inherits'</span>);
<span class="hljs-keyword">var</span> EventEmitter = <span class="hljs-built_in">require</span>(<span class="hljs-string">'events'</span>).EventEmitter;
<span class="hljs-keyword">var</span> xtend = <span class="hljs-built_in">require</span>(<span class="hljs-string">'xtend'</span>);
<span class="hljs-keyword">var</span> isArray = <span class="hljs-built_in">Array</span>.isArray;
<span class="hljs-keyword">var</span> defined = <span class="hljs-built_in">require</span>(<span class="hljs-string">'defined'</span>);
<span class="hljs-keyword">var</span> has = <span class="hljs-built_in">require</span>(<span class="hljs-string">'has'</span>);
<span class="hljs-keyword">var</span> sanitize = <span class="hljs-built_in">require</span>(<span class="hljs-string">'htmlescape'</span>).sanitize;
<span class="hljs-keyword">var</span> shasum = <span class="hljs-built_in">require</span>(<span class="hljs-string">'shasum'</span>);

<span class="hljs-keyword">var</span> bresolve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'browser-resolve'</span>);
<span class="hljs-keyword">var</span> resolve = <span class="hljs-built_in">require</span>(<span class="hljs-string">'resolve'</span>);

<span class="hljs-keyword">var</span> readonly = <span class="hljs-built_in">require</span>(<span class="hljs-string">'read-only-stream'</span>);

<span class="hljs-built_in">module</span>.exports = Browserify;
inherits(Browserify, EventEmitter);

<span class="hljs-keyword">var</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>);
<span class="hljs-keyword">var</span> path = <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> relativePath = <span class="hljs-built_in">require</span>(<span class="hljs-string">'cached-path-relative'</span>)
<span class="hljs-keyword">var</span> paths = {
    <span class="hljs-attr">empty</span>: path.join(__dirname, <span class="hljs-string">'lib/_empty.js'</span>)
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Browserify</span> (<span class="hljs-params">files, opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (!(<span class="hljs-keyword">this</span> <span class="hljs-keyword">instanceof</span> Browserify)) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Browserify(files, opts);
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> files === <span class="hljs-string">'string'</span> || isArray(files) || isStream(files)) {
        opts = xtend(opts, { <span class="hljs-attr">entries</span>: [].concat(opts.entries || [], files) });
    }
    <span class="hljs-keyword">else</span> opts = xtend(files, opts);
    
    self._options = opts;
    <span class="hljs-keyword">if</span> (opts.noparse) opts.noParse = opts.noparse;
    
    <span class="hljs-keyword">if</span> (opts.basedir !== <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">typeof</span> opts.basedir !== <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'opts.basedir must be either undefined or a string.'</span>);
    }

    opts.dedupe = opts.dedupe === <span class="hljs-literal">false</span> ? <span class="hljs-literal">false</span> : <span class="hljs-literal">true</span>;

    self._external = [];
    self._exclude = [];
    self._ignore = [];
    self._expose = {};
    self._hashes = {};
    self._pending = <span class="hljs-number">0</span>;
    self._transformOrder = <span class="hljs-number">0</span>;
    self._transformPending = <span class="hljs-number">0</span>;
    self._transforms = [];
    self._entryOrder = <span class="hljs-number">0</span>;
    self._ticked = <span class="hljs-literal">false</span>;
    self._bresolve = opts.browserField === <span class="hljs-literal">false</span>
        ? <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, opts, cb</span>) </span>{
            <span class="hljs-keyword">if</span> (!opts.basedir) opts.basedir = path.dirname(opts.filename)
            resolve(id, opts, cb)
        }
        : bresolve
    ;
    self._syntaxCache = {};

    <span class="hljs-keyword">var</span> ignoreTransform = [].concat(opts.ignoreTransform).filter(<span class="hljs-built_in">Boolean</span>);
    self._filterTransform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tr</span>) </span>{
        <span class="hljs-keyword">if</span> (isArray(tr)) {
            <span class="hljs-keyword">return</span> ignoreTransform.indexOf(tr[<span class="hljs-number">0</span>]) === <span class="hljs-number">-1</span>;
        }
        <span class="hljs-keyword">return</span> ignoreTransform.indexOf(tr) === <span class="hljs-number">-1</span>;
    };

    self.pipeline = self._createPipeline(opts);
    
    [].concat(opts.transform).filter(<span class="hljs-built_in">Boolean</span>).filter(self._filterTransform)
    .forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tr</span>) </span>{
        self.transform(tr);
    });
    
    [].concat(opts.entries).filter(<span class="hljs-built_in">Boolean</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file</span>) </span>{
        self.add(file, { <span class="hljs-attr">basedir</span>: opts.basedir });
    });
    
    [].concat(opts.require).filter(<span class="hljs-built_in">Boolean</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file</span>) </span>{
        self.require(file, { <span class="hljs-attr">basedir</span>: opts.basedir });
    });
    
    [].concat(opts.plugin).filter(<span class="hljs-built_in">Boolean</span>).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">p</span>) </span>{
        self.plugin(p, { <span class="hljs-attr">basedir</span>: opts.basedir });
    });
}

Browserify.prototype.require = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (isArray(file)) {
        file.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> x === <span class="hljs-string">'object'</span>) {
                self.require(x.file, xtend(opts, x));
            }
            <span class="hljs-keyword">else</span> self.require(x, opts);
        });
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, self._options.basedir, process.cwd());
    <span class="hljs-keyword">var</span> expose = opts.expose;
    <span class="hljs-keyword">if</span> (file === expose &amp;&amp; <span class="hljs-regexp">/^[\.]/</span>.test(expose)) {
        expose = <span class="hljs-string">'/'</span> + relativePath(basedir, expose);
        expose = expose.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
    }
    <span class="hljs-keyword">if</span> (expose === <span class="hljs-literal">undefined</span> &amp;&amp; <span class="hljs-keyword">this</span>._options.exposeAll) {
        expose = <span class="hljs-literal">true</span>;
    }
    <span class="hljs-keyword">if</span> (expose === <span class="hljs-literal">true</span>) {
        expose = <span class="hljs-string">'/'</span> + relativePath(basedir, file);
        expose = expose.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
    }
    
    <span class="hljs-keyword">if</span> (isStream(file)) {
        self._pending ++;
        <span class="hljs-keyword">var</span> order = self._entryOrder ++;
        file.pipe(concat(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">buf</span>) </span>{
            <span class="hljs-keyword">var</span> filename = opts.file || file.file || path.join(
                basedir,
                <span class="hljs-string">'_stream_'</span> + order + <span class="hljs-string">'.js'</span>
            );
            <span class="hljs-keyword">var</span> id = file.id || expose || filename;
            <span class="hljs-keyword">if</span> (expose || opts.entry === <span class="hljs-literal">false</span>) {
                self._expose[id] = filename;
            }
            <span class="hljs-keyword">if</span> (!opts.entry &amp;&amp; self._options.exports === <span class="hljs-literal">undefined</span>) {
                self._bpack.hasExports = <span class="hljs-literal">true</span>;
            }
            <span class="hljs-keyword">var</span> rec = {
                <span class="hljs-attr">source</span>: buf.toString(<span class="hljs-string">'utf8'</span>),
                <span class="hljs-attr">entry</span>: defined(opts.entry, <span class="hljs-literal">false</span>),
                <span class="hljs-attr">file</span>: filename,
                <span class="hljs-attr">id</span>: id
            };
            <span class="hljs-keyword">if</span> (rec.entry) rec.order = order;
            <span class="hljs-keyword">if</span> (rec.transform === <span class="hljs-literal">false</span>) rec.transform = <span class="hljs-literal">false</span>;
            self.pipeline.write(rec);
            
            <span class="hljs-keyword">if</span> (-- self._pending === <span class="hljs-number">0</span>) self.emit(<span class="hljs-string">'_ready'</span>);
        }));
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-keyword">var</span> row;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> file === <span class="hljs-string">'object'</span>) {
        row = xtend(file, opts);
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (!opts.entry &amp;&amp; isExternalModule(file)) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>external module or builtin</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        row = xtend(opts, { <span class="hljs-attr">id</span>: expose || file, <span class="hljs-attr">file</span>: file });
    }
    <span class="hljs-keyword">else</span> {
        row = xtend(opts, { <span class="hljs-attr">file</span>: path.resolve(basedir, file) });
    }
    
    <span class="hljs-keyword">if</span> (!row.id) {
        row.id = expose || row.file;
    }
    <span class="hljs-keyword">if</span> (expose || !row.entry) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>Make this available to mdeps so that it can assign the value when it
resolves the pathname.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        row.expose = row.id;
    }
    
    <span class="hljs-keyword">if</span> (opts.external) <span class="hljs-keyword">return</span> self.external(file, opts);
    <span class="hljs-keyword">if</span> (row.entry === <span class="hljs-literal">undefined</span>) row.entry = <span class="hljs-literal">false</span>;
    
    <span class="hljs-keyword">if</span> (!row.entry &amp;&amp; self._options.exports === <span class="hljs-literal">undefined</span>) {
        self._bpack.hasExports = <span class="hljs-literal">true</span>;
    }
    
    <span class="hljs-keyword">if</span> (row.entry) row.order = self._entryOrder ++;
    
    <span class="hljs-keyword">if</span> (opts.transform === <span class="hljs-literal">false</span>) row.transform = <span class="hljs-literal">false</span>;
    self.pipeline.write(row);
    <span class="hljs-keyword">return</span> self;
};

Browserify.prototype.add = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">if</span> (isArray(file)) {
        file.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{ self.add(x, opts) });
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.require(file, xtend({ <span class="hljs-attr">entry</span>: <span class="hljs-literal">true</span>, <span class="hljs-attr">expose</span>: <span class="hljs-literal">false</span> }, opts));
};

Browserify.prototype.external = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (isArray(file)) {
        file.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">f</span>) </span>{
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> f === <span class="hljs-string">'object'</span>) {
                self.external(f, xtend(opts, f));
            }
            <span class="hljs-keyword">else</span> self.external(f, opts)
        });
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    <span class="hljs-keyword">if</span> (file &amp;&amp; <span class="hljs-keyword">typeof</span> file === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-keyword">typeof</span> file.bundle === <span class="hljs-string">'function'</span>) {
        <span class="hljs-keyword">var</span> b = file;
        self._pending ++;

        <span class="hljs-keyword">var</span> bdeps = {};
        <span class="hljs-keyword">var</span> blabels = {};

        b.on(<span class="hljs-string">'label'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">prev, id</span>) </span>{
            self._external.push(id);

            <span class="hljs-keyword">if</span> (prev !== id) {
                blabels[prev] = id;
                self._external.push(prev);
            }
        });

        b.pipeline.get(<span class="hljs-string">'deps'</span>).push(through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
            bdeps = xtend(bdeps, row.deps);
            <span class="hljs-keyword">this</span>.push(row);
            next();
        }));

        self.on(<span class="hljs-string">'dep'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row</span>) </span>{
            <span class="hljs-built_in">Object</span>.keys(row.deps).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
                <span class="hljs-keyword">var</span> prev = bdeps[key];
                <span class="hljs-keyword">if</span> (prev) {
                    <span class="hljs-keyword">var</span> id = blabels[prev];
                    <span class="hljs-keyword">if</span> (id) {
                        row.indexDeps[key] = id;
                    }
                }
            });
        });

        b.pipeline.get(<span class="hljs-string">'label'</span>).once(<span class="hljs-string">'end'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            <span class="hljs-keyword">if</span> (-- self._pending === <span class="hljs-number">0</span>) self.emit(<span class="hljs-string">'_ready'</span>);
        });
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }
    
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());
    <span class="hljs-keyword">this</span>._external.push(file);
    <span class="hljs-keyword">this</span>._external.push(<span class="hljs-string">'/'</span> + relativePath(basedir, file));
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Browserify.prototype.exclude = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, opts</span>) </span>{
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());
    <span class="hljs-keyword">this</span>._exclude.push(file);
    <span class="hljs-keyword">this</span>._exclude.push(<span class="hljs-string">'/'</span> + relativePath(basedir, file));
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Browserify.prototype.ignore = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, opts</span>) </span>{
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Handle relative paths</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (file[<span class="hljs-number">0</span>] === <span class="hljs-string">'.'</span>) {
        <span class="hljs-keyword">this</span>._ignore.push(path.resolve(basedir, file));
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">this</span>._ignore.push(file);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Browserify.prototype.transform = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tr, opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> opts === <span class="hljs-string">'function'</span> || <span class="hljs-keyword">typeof</span> opts === <span class="hljs-string">'string'</span>) {
        tr = [ opts, tr ];
    }
    <span class="hljs-keyword">if</span> (isArray(tr)) {
        opts = tr[<span class="hljs-number">1</span>];
        tr = tr[<span class="hljs-number">0</span>];
    }
    
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>if the bundler is ignoring this transform</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> tr === <span class="hljs-string">'string'</span> &amp;&amp; !self._filterTransform(tr)) {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolved</span> (<span class="hljs-params"></span>) </span>{
      self._transforms[order] = rec;
      -- self._pending;
      <span class="hljs-keyword">if</span> (-- self._transformPending === <span class="hljs-number">0</span>) {
          self._transforms.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">transform</span>) </span>{
            self.pipeline.write(transform);
          });

          <span class="hljs-keyword">if</span> (self._pending === <span class="hljs-number">0</span>) {
            self.emit(<span class="hljs-string">'_ready'</span>);
          }
      }
    }
    
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    opts._flags = <span class="hljs-string">'_flags'</span> <span class="hljs-keyword">in</span> opts ? opts._flags : self._options;
    
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, <span class="hljs-keyword">this</span>._options.basedir, process.cwd());
    <span class="hljs-keyword">var</span> order = self._transformOrder ++;
    self._pending ++;
    self._transformPending ++;

    <span class="hljs-keyword">var</span> rec = {
        <span class="hljs-attr">transform</span>: tr,
        <span class="hljs-attr">options</span>: opts,
        <span class="hljs-attr">global</span>: opts.global
    };

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> tr === <span class="hljs-string">'string'</span>) {
        <span class="hljs-keyword">var</span> topts = {
            <span class="hljs-attr">basedir</span>: basedir,
            <span class="hljs-attr">paths</span>: (self._options.paths || []).map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">p</span>) </span>{
                <span class="hljs-keyword">return</span> path.resolve(basedir, p);
            })
        };
        resolve(tr, topts, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, res</span>) </span>{
            <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> self.emit(<span class="hljs-string">'error'</span>, err);
            rec.transform = res;
            resolved();
        });
    }
    <span class="hljs-keyword">else</span> process.nextTick(resolved);
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Browserify.prototype.plugin = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">p, opts</span>) </span>{
    <span class="hljs-keyword">if</span> (isArray(p)) {
        opts = p[<span class="hljs-number">1</span>];
        p = p[<span class="hljs-number">0</span>];
    }
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, <span class="hljs-keyword">this</span>._options.basedir, process.cwd());
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> p === <span class="hljs-string">'function'</span>) {
        p(<span class="hljs-keyword">this</span>, opts);
    }
    <span class="hljs-keyword">else</span> {
        <span class="hljs-keyword">var</span> pfile = resolve.sync(<span class="hljs-built_in">String</span>(p), { <span class="hljs-attr">basedir</span>: basedir })
        <span class="hljs-keyword">var</span> f = <span class="hljs-built_in">require</span>(pfile);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> f !== <span class="hljs-string">'function'</span>) {
            <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">'plugin '</span> + p + <span class="hljs-string">' should export a function'</span>);
        }
        f(<span class="hljs-keyword">this</span>, opts);
    }
    <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Browserify.prototype._createPipeline = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">this</span>._mdeps = <span class="hljs-keyword">this</span>._createDeps(opts);
    <span class="hljs-keyword">this</span>._mdeps.on(<span class="hljs-string">'file'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, id</span>) </span>{
        pipeline.emit(<span class="hljs-string">'file'</span>, file, id);
        self.emit(<span class="hljs-string">'file'</span>, file, id);
    });
    <span class="hljs-keyword">this</span>._mdeps.on(<span class="hljs-string">'package'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">pkg</span>) </span>{
        pipeline.emit(<span class="hljs-string">'package'</span>, pkg);
        self.emit(<span class="hljs-string">'package'</span>, pkg);
    });
    <span class="hljs-keyword">this</span>._mdeps.on(<span class="hljs-string">'transform'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">tr, file</span>) </span>{
        pipeline.emit(<span class="hljs-string">'transform'</span>, tr, file);
        self.emit(<span class="hljs-string">'transform'</span>, tr, file);
    });
    
    <span class="hljs-keyword">var</span> dopts = {
        <span class="hljs-attr">index</span>: !opts.fullPaths &amp;&amp; !opts.exposeAll,
        <span class="hljs-attr">dedupe</span>: opts.dedupe,
        <span class="hljs-attr">expose</span>: <span class="hljs-keyword">this</span>._expose
    };
    <span class="hljs-keyword">this</span>._bpack = bpack(xtend(opts, { <span class="hljs-attr">raw</span>: <span class="hljs-literal">true</span> }));
    
    <span class="hljs-keyword">var</span> pipeline = splicer.obj([
        <span class="hljs-string">'record'</span>, [ <span class="hljs-keyword">this</span>._recorder() ],
        <span class="hljs-string">'deps'</span>, [ <span class="hljs-keyword">this</span>._mdeps ],
        <span class="hljs-string">'json'</span>, [ <span class="hljs-keyword">this</span>._json() ],
        <span class="hljs-string">'unbom'</span>, [ <span class="hljs-keyword">this</span>._unbom() ],
        <span class="hljs-string">'unshebang'</span>, [ <span class="hljs-keyword">this</span>._unshebang() ],
        <span class="hljs-string">'syntax'</span>, [ <span class="hljs-keyword">this</span>._syntax() ],
        <span class="hljs-string">'sort'</span>, [ depsSort(dopts) ],
        <span class="hljs-string">'dedupe'</span>, [ <span class="hljs-keyword">this</span>._dedupe() ],
        <span class="hljs-string">'label'</span>, [ <span class="hljs-keyword">this</span>._label(opts) ],
        <span class="hljs-string">'emit-deps'</span>, [ <span class="hljs-keyword">this</span>._emitDeps() ],
        <span class="hljs-string">'debug'</span>, [ <span class="hljs-keyword">this</span>._debug(opts) ],
        <span class="hljs-string">'pack'</span>, [ <span class="hljs-keyword">this</span>._bpack ],
        <span class="hljs-string">'wrap'</span>, []
    ]);
    <span class="hljs-keyword">if</span> (opts.exposeAll) {
        <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());
        pipeline.get(<span class="hljs-string">'deps'</span>).push(through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
            <span class="hljs-keyword">if</span> (self._external.indexOf(row.id) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> next();
            <span class="hljs-keyword">if</span> (self._external.indexOf(row.file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> next();
            
            <span class="hljs-keyword">if</span> (isAbsolutePath(row.id)) {
                row.id = <span class="hljs-string">'/'</span> + relativePath(basedir, row.file);
            }
            <span class="hljs-built_in">Object</span>.keys(row.deps || {}).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
                row.deps[key] = <span class="hljs-string">'/'</span> + relativePath(basedir, row.deps[key]);
            });
            <span class="hljs-keyword">this</span>.push(row);
            next();
        }));
    }
    <span class="hljs-keyword">return</span> pipeline;
};

Browserify.prototype._createDeps = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> mopts = xtend(opts);
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Let mdeps populate these values since it will be resolving file paths
anyway.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    mopts.expose = <span class="hljs-keyword">this</span>._expose;
    mopts.extensions = [ <span class="hljs-string">'.js'</span>, <span class="hljs-string">'.json'</span> ].concat(mopts.extensions || []);
    self._extensions = mopts.extensions;

    mopts.transform = [];
    mopts.transformKey = defined(opts.transformKey, [ <span class="hljs-string">'browserify'</span>, <span class="hljs-string">'transform'</span> ]);
    mopts.postFilter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, file, pkg</span>) </span>{
        <span class="hljs-keyword">if</span> (opts.postFilter &amp;&amp; !opts.postFilter(id, file, pkg)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (self._external.indexOf(file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (self._exclude.indexOf(file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>filter transforms on module dependencies</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        <span class="hljs-keyword">if</span> (pkg &amp;&amp; pkg.browserify &amp;&amp; pkg.browserify.transform) {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>In edge cases it may be a string</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">            pkg.browserify.transform = [].concat(pkg.browserify.transform)
                    .filter(<span class="hljs-built_in">Boolean</span>)
                    .filter(self._filterTransform);
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    };
    mopts.filter = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id</span>) </span>{
        <span class="hljs-keyword">if</span> (opts.filter &amp;&amp; !opts.filter(id)) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (self._external.indexOf(id) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (self._exclude.indexOf(id) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        <span class="hljs-keyword">if</span> (opts.bundleExternal === <span class="hljs-literal">false</span> &amp;&amp; isExternalModule(id)) {
            <span class="hljs-keyword">return</span> <span class="hljs-literal">false</span>;
        }
        <span class="hljs-keyword">return</span> <span class="hljs-literal">true</span>;
    };
    mopts.resolve = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">id, parent, cb</span>) </span>{
        <span class="hljs-keyword">if</span> (self._ignore.indexOf(id) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, paths.empty, {});
        
        self._bresolve(id, parent, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, file, pkg</span>) </span>{
            <span class="hljs-keyword">if</span> (file &amp;&amp; self._ignore.indexOf(file) &gt;= <span class="hljs-number">0</span>) {
                <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, paths.empty, {});
            }
            <span class="hljs-keyword">if</span> (file &amp;&amp; self._ignore.length) {
                <span class="hljs-keyword">var</span> nm = file.split(<span class="hljs-string">'/node_modules/'</span>)[<span class="hljs-number">1</span>];
                <span class="hljs-keyword">if</span> (nm) {
                    nm = nm.split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">0</span>];
                    <span class="hljs-keyword">if</span> (self._ignore.indexOf(nm) &gt;= <span class="hljs-number">0</span>) {
                        <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, paths.empty, {});
                    }
                }
            }
            
            <span class="hljs-keyword">if</span> (file) {
                <span class="hljs-keyword">var</span> ex = <span class="hljs-string">'/'</span> + relativePath(basedir, file);
                <span class="hljs-keyword">if</span> (self._external.indexOf(ex) &gt;= <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, ex);
                }
                <span class="hljs-keyword">if</span> (self._exclude.indexOf(ex) &gt;= <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, ex);
                }
                <span class="hljs-keyword">if</span> (self._ignore.indexOf(ex) &gt;= <span class="hljs-number">0</span>) {
                    <span class="hljs-keyword">return</span> cb(<span class="hljs-literal">null</span>, paths.empty, {});
                }
            }
            <span class="hljs-keyword">if</span> (err) cb(err, file, pkg)
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (file) fs.realpath(file, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">err, res</span>) </span>{
                cb(err, res, pkg, file);
            });
            <span class="hljs-keyword">else</span> cb(err, <span class="hljs-literal">null</span>, pkg)
        });
    };
    
    <span class="hljs-keyword">if</span> (opts.builtins === <span class="hljs-literal">false</span>) {
        mopts.modules = {};
        self._exclude.push.apply(self._exclude, <span class="hljs-built_in">Object</span>.keys(builtins));
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opts.builtins &amp;&amp; isArray(opts.builtins)) {
        mopts.modules = {};
        opts.builtins.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
            mopts.modules[key] = builtins[key];
        });
    }
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (opts.builtins &amp;&amp; <span class="hljs-keyword">typeof</span> opts.builtins === <span class="hljs-string">'object'</span>) {
        mopts.modules = opts.builtins;
    }
    <span class="hljs-keyword">else</span> mopts.modules = xtend(builtins);
    
    <span class="hljs-built_in">Object</span>.keys(builtins).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
        <span class="hljs-keyword">if</span> (!has(mopts.modules, key)) self._exclude.push(key);
    });
    
    mopts.globalTransform = [];
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._bundled) {
        <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'bundle'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            self.pipeline.write({
                <span class="hljs-attr">transform</span>: globalTr,
                <span class="hljs-attr">global</span>: <span class="hljs-literal">true</span>,
                <span class="hljs-attr">options</span>: {}
            });
        });
    }
    
    <span class="hljs-keyword">var</span> no = [].concat(opts.noParse).filter(<span class="hljs-built_in">Boolean</span>);
    <span class="hljs-keyword">var</span> absno = no.filter(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">x</span>) </span>{
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">typeof</span> x === <span class="hljs-string">'string'</span>;
    }).map(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{
        <span class="hljs-keyword">return</span> path.resolve(basedir, x);
    });
    
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">globalTr</span> (<span class="hljs-params">file</span>) </span>{
        <span class="hljs-keyword">if</span> (opts.detectGlobals === <span class="hljs-literal">false</span>) <span class="hljs-keyword">return</span> through();
        
        <span class="hljs-keyword">if</span> (opts.noParse === <span class="hljs-literal">true</span>) <span class="hljs-keyword">return</span> through();
        <span class="hljs-keyword">if</span> (no.indexOf(file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> through();
        <span class="hljs-keyword">if</span> (absno.indexOf(file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> through();
        
        <span class="hljs-keyword">var</span> parts = file.split(<span class="hljs-string">'/node_modules/'</span>);
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; no.length; i++) {
            <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> no[i] === <span class="hljs-string">'function'</span> &amp;&amp; no[i](file)) {
                <span class="hljs-keyword">return</span> through();
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (no[i] === parts[parts.length<span class="hljs-number">-1</span>].split(<span class="hljs-string">'/'</span>)[<span class="hljs-number">0</span>]) {
                <span class="hljs-keyword">return</span> through();
            }
            <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (no[i] === parts[parts.length<span class="hljs-number">-1</span>]) {
                <span class="hljs-keyword">return</span> through();
            }
        }
        
        <span class="hljs-keyword">var</span> vars = xtend({
            <span class="hljs-attr">process</span>: <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-string">"require('_process')"</span> },
        }, opts.insertGlobalVars);
        
        <span class="hljs-keyword">if</span> (opts.bundleExternal === <span class="hljs-literal">false</span>) {
            vars.process = <span class="hljs-literal">undefined</span>;
            vars.buffer = <span class="hljs-literal">undefined</span>;
        }
        
        <span class="hljs-keyword">return</span> insertGlobals(file, xtend(opts, {
            <span class="hljs-attr">debug</span>: opts.debug,
            <span class="hljs-attr">always</span>: opts.insertGlobals,
            <span class="hljs-attr">basedir</span>: opts.commondir === <span class="hljs-literal">false</span>
                ? <span class="hljs-string">'/'</span>
                : opts.basedir || process.cwd()
            ,
            <span class="hljs-attr">vars</span>: vars
        }));
    }
    <span class="hljs-keyword">return</span> mdeps(mopts);
};

Browserify.prototype._recorder = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> ended = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>._recorded = [];
    
    <span class="hljs-keyword">if</span> (!<span class="hljs-keyword">this</span>._ticked) {
        process.nextTick(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
            self._ticked = <span class="hljs-literal">true</span>;
            self._recorded.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row</span>) </span>{
                stream.push(row);
            });
            <span class="hljs-keyword">if</span> (ended) stream.push(<span class="hljs-literal">null</span>);
        });
    }
    
    <span class="hljs-keyword">var</span> stream = through.obj(write, end);
    <span class="hljs-keyword">return</span> stream;
    
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">write</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        self._recorded.push(row);
        <span class="hljs-keyword">if</span> (self._ticked) <span class="hljs-keyword">this</span>.push(row);
        next();
    }
    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">end</span> (<span class="hljs-params"></span>) </span>{
        ended = <span class="hljs-literal">true</span>;
        <span class="hljs-keyword">if</span> (self._ticked) <span class="hljs-keyword">this</span>.push(<span class="hljs-literal">null</span>);
    }
};

Browserify.prototype._json = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/\.json$/</span>.test(row.file)) {
            row.source = <span class="hljs-string">'module.exports='</span> + sanitize(row.source);
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._unbom = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^\ufeff/</span>.test(row.source)) {
            row.source = row.source.replace(<span class="hljs-regexp">/^\ufeff/</span>, <span class="hljs-string">''</span>);
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._unshebang = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">if</span> (<span class="hljs-regexp">/^#!/</span>.test(row.source)) {
            row.source = row.source.replace(<span class="hljs-regexp">/^#![^\n]*\n/</span>, <span class="hljs-string">''</span>);
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._syntax = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">var</span> h = shasum(row.source);
        <span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> self._syntaxCache[h] === <span class="hljs-string">'undefined'</span>) {
            <span class="hljs-keyword">var</span> err = syntaxError(row.source, row.file || row.id);
            <span class="hljs-keyword">if</span> (err) <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.emit(<span class="hljs-string">'error'</span>, err);
            self._syntaxCache[h] = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._dedupe = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">if</span> (!row.dedupeIndex &amp;&amp; row.dedupe) {
            row.source = <span class="hljs-string">'arguments[4]['</span>
                + <span class="hljs-built_in">JSON</span>.stringify(row.dedupe)
                + <span class="hljs-string">'][0].apply(exports,arguments)'</span>
            ;
            row.nomap = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (row.dedupeIndex) {
            row.source = <span class="hljs-string">'arguments[4]['</span>
                + <span class="hljs-built_in">JSON</span>.stringify(row.dedupeIndex)
                + <span class="hljs-string">'][0].apply(exports,arguments)'</span>
            ;
            row.nomap = <span class="hljs-literal">true</span>;
        }
        <span class="hljs-keyword">if</span> (row.dedupeIndex &amp;&amp; row.indexDeps) {
            row.indexDeps.dup = row.dedupeIndex;
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._label = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());
    
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">var</span> prev = row.id;

        <span class="hljs-keyword">if</span> (self._external.indexOf(row.id) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> next();
        <span class="hljs-keyword">if</span> (self._external.indexOf(<span class="hljs-string">'/'</span> + relativePath(basedir, row.id)) &gt;= <span class="hljs-number">0</span>) {
            <span class="hljs-keyword">return</span> next();
        }
        <span class="hljs-keyword">if</span> (self._external.indexOf(row.file) &gt;= <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> next();
        
        <span class="hljs-keyword">if</span> (row.index) row.id = row.index;
        
        self.emit(<span class="hljs-string">'label'</span>, prev, row.id);
        <span class="hljs-keyword">if</span> (row.indexDeps) row.deps = row.indexDeps || {};
        
        <span class="hljs-built_in">Object</span>.keys(row.deps).forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">key</span>) </span>{
            <span class="hljs-keyword">if</span> (self._expose[key]) {
                row.deps[key] = key;
                <span class="hljs-keyword">return</span>;
            }

            <span class="hljs-keyword">var</span> afile = path.resolve(path.dirname(row.file), key);
            <span class="hljs-keyword">var</span> rfile = <span class="hljs-string">'/'</span> + relativePath(basedir, afile);
            <span class="hljs-keyword">if</span> (self._external.indexOf(rfile) &gt;= <span class="hljs-number">0</span>) {
                row.deps[key] = rfile;
            }
            <span class="hljs-keyword">if</span> (self._external.indexOf(afile) &gt;= <span class="hljs-number">0</span>) {
                row.deps[key] = rfile;
            }
            <span class="hljs-keyword">if</span> (self._external.indexOf(key) &gt;= <span class="hljs-number">0</span>) {
                row.deps[key] = key;
                <span class="hljs-keyword">return</span>;
            }
            
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>; i &lt; self._extensions.length; i++) {
                <span class="hljs-keyword">var</span> ex = self._extensions[i];
                <span class="hljs-keyword">if</span> (self._external.indexOf(rfile + ex) &gt;= <span class="hljs-number">0</span>) {
                    row.deps[key] = rfile + ex;
                    <span class="hljs-keyword">break</span>;
                }
            }
        });
        
        <span class="hljs-keyword">if</span> (row.entry || row.expose) {
            self._bpack.standaloneModule = row.id;
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype._emitDeps = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        self.emit(<span class="hljs-string">'dep'</span>, row);
        <span class="hljs-keyword">this</span>.push(row);
        next();
    })
};

Browserify.prototype._debug = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">var</span> basedir = defined(opts.basedir, process.cwd());
    <span class="hljs-keyword">return</span> through.obj(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">row, enc, next</span>) </span>{
        <span class="hljs-keyword">if</span> (opts.debug) {
            row.sourceRoot = <span class="hljs-string">'file://localhost'</span>;
            row.sourceFile = relativePath(basedir, row.file)
                .replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
        }
        <span class="hljs-keyword">this</span>.push(row);
        next();
    });
};

Browserify.prototype.reset = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts</span>) </span>{
    <span class="hljs-keyword">if</span> (!opts) opts = {};
    <span class="hljs-keyword">var</span> hadExports = <span class="hljs-keyword">this</span>._bpack.hasExports;
    <span class="hljs-keyword">this</span>.pipeline = <span class="hljs-keyword">this</span>._createPipeline(xtend(opts, <span class="hljs-keyword">this</span>._options));
    <span class="hljs-keyword">this</span>._bpack.hasExports = hadExports;
    <span class="hljs-keyword">this</span>._entryOrder = <span class="hljs-number">0</span>;
    <span class="hljs-keyword">this</span>._bundled = <span class="hljs-literal">false</span>;
    <span class="hljs-keyword">this</span>.emit(<span class="hljs-string">'reset'</span>);
};

Browserify.prototype.bundle = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">cb</span>) </span>{
    <span class="hljs-keyword">var</span> self = <span class="hljs-keyword">this</span>;
    <span class="hljs-keyword">if</span> (cb &amp;&amp; <span class="hljs-keyword">typeof</span> cb === <span class="hljs-string">'object'</span>) {
        <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(
            <span class="hljs-string">'bundle() no longer accepts option arguments.\n'</span>
            + <span class="hljs-string">'Move all option arguments to the browserify() constructor.'</span>
        );
    }
    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._bundled) {
        <span class="hljs-keyword">var</span> recorded = <span class="hljs-keyword">this</span>._recorded;
        <span class="hljs-keyword">this</span>.reset();
        recorded.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">x</span>) </span>{
            self.pipeline.write(x);
        });
    }
    <span class="hljs-keyword">var</span> output = readonly(<span class="hljs-keyword">this</span>.pipeline);
    <span class="hljs-keyword">if</span> (cb) {
        output.on(<span class="hljs-string">'error'</span>, cb);
        output.pipe(concat(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">body</span>) </span>{
            cb(<span class="hljs-literal">null</span>, body);
        }));
    }

    <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ready</span> (<span class="hljs-params"></span>) </span>{
        self.emit(<span class="hljs-string">'bundle'</span>, output);
        self.pipeline.end();
    }

    <span class="hljs-keyword">if</span> (<span class="hljs-keyword">this</span>._pending === <span class="hljs-number">0</span>) ready();
    <span class="hljs-keyword">else</span> <span class="hljs-keyword">this</span>.once(<span class="hljs-string">'_ready'</span>, ready);

    <span class="hljs-keyword">this</span>._bundled = <span class="hljs-literal">true</span>;
    <span class="hljs-keyword">return</span> output;
};

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isStream</span> (<span class="hljs-params">s</span>) </span>{ <span class="hljs-keyword">return</span> s &amp;&amp; <span class="hljs-keyword">typeof</span> s.pipe === <span class="hljs-string">'function'</span> }
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isAbsolutePath</span> (<span class="hljs-params">file</span>) </span>{
    <span class="hljs-keyword">var</span> regexp = process.platform === <span class="hljs-string">'win32'</span> ?
        <span class="hljs-regexp">/^\w:/</span> :
        <span class="hljs-regexp">/^\//</span>;
    <span class="hljs-keyword">return</span> regexp.test(file);
}
<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isExternalModule</span> (<span class="hljs-params">file</span>) </span>{
    <span class="hljs-keyword">var</span> regexp = process.platform === <span class="hljs-string">'win32'</span> ?
        <span class="hljs-regexp">/^(\.|\w:)/</span> :
        <span class="hljs-regexp">/^[\/.]/</span>;
    <span class="hljs-keyword">return</span> !regexp.test(file);
}

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
