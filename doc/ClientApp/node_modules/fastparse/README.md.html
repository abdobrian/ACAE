<!DOCTYPE html>
<html>
<head>
  <title>README.md</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "ClientApp\\node_modules\\fastparse\\README.md";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

      <div class="heading h1">
        <a href="#fastparse">fastparse</a>
      </div>

      <div class="heading h2">
        <a href="#usage">Usage</a>
      </div>

      <div class="heading h2">
        <a href="#example">Example</a>
      </div>

      <div class="heading h2">
        <a href="#license">License</a>
      </div>

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="docs markdown"><div class="pilwrap" id="fastparse">
  <h1>
    <a href="#fastparse" name="fastparse" class="pilcrow"></a>
fastparse
  </h1>
</div>
<p>A very simple and stupid parser, based on a statemachine and regular expressions.</p>
<p>It's not intended for complex languages. It's intended to easily write a simple parser for a simple language.</p>
<div class="pilwrap" id="usage">
  <h2>
    <a href="#usage" name="usage" class="pilcrow"></a>
Usage
  </h2>
</div>
<p>Pass a description of statemachine to the constructor. The description must be in this form:</p>
<pre><code class="javascript"><span class="hljs-keyword">new</span> Parser(description)

description is {
	<span class="hljs-comment">// The key is the name of the state</span>
	<span class="hljs-comment">// The value is an object containing possible transitions</span>
	<span class="hljs-string">"state-name"</span>: {
		<span class="hljs-comment">// The key is a regular expression</span>
		<span class="hljs-comment">// If the regular expression matches the transition is executed</span>
		<span class="hljs-comment">// The value can be "true", a other state name or a function</span>

		<span class="hljs-string">"a"</span>: <span class="hljs-literal">true</span>,
		<span class="hljs-comment">// true will make the parser stay in the current state</span>
		
		<span class="hljs-string">"b"</span>: <span class="hljs-string">"other-state-name"</span>,
		<span class="hljs-comment">// a string will make the parser transit to a new state</span>
		
		<span class="hljs-string">"[cde]"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, index, matchLength</span>) </span>{
			<span class="hljs-comment">// "match" will be the matched string</span>
			<span class="hljs-comment">// "index" will be the position in the complete string</span>
			<span class="hljs-comment">// "matchLength" will be "match.length"</span>
			
			<span class="hljs-comment">// "this" will be the "context" passed to the "parse" method"</span>
			
			<span class="hljs-comment">// A new state name (string) can be returned</span>
			<span class="hljs-keyword">return</span> <span class="hljs-string">"other-state-name"</span>;
		},
		
		<span class="hljs-string">"([0-9]+)(\\.[0-9]+)?"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, first, second, index, matchLength</span>) </span>{
			<span class="hljs-comment">// groups can be used in the regular expression</span>
			<span class="hljs-comment">// they will match to arguments "first", "second"</span>
		},
		
		<span class="hljs-comment">// the parser stops when it cannot match the string anymore</span>
		
		<span class="hljs-comment">// order of keys is the order in which regular expressions are matched</span>
		<span class="hljs-comment">// if the javascript runtime preserves the order of keys in an object</span>
		<span class="hljs-comment">// (this is not standardized, but it's a de-facto standard)</span>
	}
}
</code></pre>
<p>The statemachine is compiled down to a single regular expression per state. So basically the parsing work is delegated to the (native) regular expression logic of the javascript runtime.</p>
<pre><code class="javascript">Parser.prototype.parse(initialState: <span class="hljs-built_in">String</span>, <span class="hljs-attr">parsedString</span>: <span class="hljs-built_in">String</span>, <span class="hljs-attr">context</span>: <span class="hljs-built_in">Object</span>)
</code></pre>
<p><code>initialState</code>: state where the parser starts to parse.</p>
<p><code>parsedString</code>: the string which should be parsed.</p>
<p><code>context</code>: an object which can be used to save state and results. Available as <code>this</code> in transition functions.</p>
<p>returns <code>context</code></p>
<div class="pilwrap" id="example">
  <h2>
    <a href="#example" name="example" class="pilcrow"></a>
Example
  </h2>
</div>
<pre><code class="javascript"><span class="hljs-keyword">var</span> Parser = <span class="hljs-built_in">require</span>(<span class="hljs-string">"fastparse"</span>);

<span class="hljs-comment">// A simple parser that extracts @licence ... from comments in a JS file</span>
<span class="hljs-keyword">var</span> parser = <span class="hljs-keyword">new</span> Parser({
	<span class="hljs-comment">// The "source" state</span>
	<span class="hljs-string">"source"</span>: {
		<span class="hljs-comment">// matches comment start</span>
		<span class="hljs-string">"/\\*"</span>: <span class="hljs-string">"comment"</span>,
		<span class="hljs-string">"//"</span>: <span class="hljs-string">"linecomment"</span>,
		
		<span class="hljs-comment">// this would be necessary for a complex language like JS</span>
		<span class="hljs-comment">// but omitted here for simplicity</span>
		<span class="hljs-comment">// "\"": "string1",</span>
		<span class="hljs-comment">// "\'": "string2",</span>
		<span class="hljs-comment">// "\/": "regexp"</span>
		
	},
	<span class="hljs-comment">// The "comment" state</span>
	<span class="hljs-string">"comment"</span>: {
		<span class="hljs-string">"\\*/"</span>: <span class="hljs-string">"source"</span>,
		<span class="hljs-string">"@licen[cs]e\\s((?:[^*\n]|\\*+[^*/\n])*)"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, licenseText</span>) </span>{
			<span class="hljs-keyword">this</span>.licences.push(licenseText.trim());
		}
	},
	<span class="hljs-comment">// The "linecomment" state</span>
	<span class="hljs-string">"linecomment"</span>: {
		<span class="hljs-string">"\n"</span>: <span class="hljs-string">"source"</span>,
		<span class="hljs-string">"@licen[cs]e\\s(.*)"</span>: <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">match, licenseText</span>) </span>{
			<span class="hljs-keyword">this</span>.licences.push(licenseText.trim());
		}
	}
});

<span class="hljs-keyword">var</span> licences = parser.parse(<span class="hljs-string">"source"</span>, sourceCode, { <span class="hljs-attr">licences</span>: [] }).licences;

<span class="hljs-built_in">console</span>.log(licences);
</code></pre>
<div class="pilwrap" id="license">
  <h2>
    <a href="#license" name="license" class="pilcrow"></a>
License
  </h2>
</div>
<p>MIT (http://www.opensource.org/licenses/mit-license.php)</p>
</div>
  </div>
</body>
</html>
