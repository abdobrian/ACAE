<!DOCTYPE html>
<html>
<head>
  <title>buffer-more-ints.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "ClientApp\\node_modules\\buffer-more-ints\\buffer-more-ints.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>buffer-more-ints.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> assert = <span class="hljs-built_in">require</span>(<span class="hljs-string">"assert"</span>);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<p>JavaScript is numerically challenged</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> SHIFT_LEFT_32 = (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>) * (<span class="hljs-number">1</span> &lt;&lt; <span class="hljs-number">16</span>);
<span class="hljs-keyword">var</span> SHIFT_RIGHT_32 = <span class="hljs-number">1</span> / SHIFT_LEFT_32;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>The maximum contiguous integer that can be held in a IEEE754 double</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> MAX_INT = <span class="hljs-number">0x1fffffffffffff</span>;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">isContiguousInt</span>(<span class="hljs-params">val</span>) </span>{
    <span class="hljs-keyword">return</span> val &lt;= MAX_INT &amp;&amp; val &gt;= -MAX_INT;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">assertContiguousInt</span>(<span class="hljs-params">val</span>) </span>{
    assert(isContiguousInt(val), <span class="hljs-string">"number cannot be represented as a contiguous integer"</span>);
}

<span class="hljs-built_in">module</span>.exports.isContiguousInt = isContiguousInt;
<span class="hljs-built_in">module</span>.exports.assertContiguousInt = assertContiguousInt;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>Fill in the regular procedures</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">[<span class="hljs-string">'UInt'</span>, <span class="hljs-string">'Int'</span>].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sign</span>) </span>{
  <span class="hljs-keyword">var</span> suffix = sign + <span class="hljs-string">'8'</span>;
  <span class="hljs-built_in">module</span>.exports[<span class="hljs-string">'read'</span> + suffix] =
    Buffer.prototype[<span class="hljs-string">'read'</span> + suffix].call;
  <span class="hljs-built_in">module</span>.exports[<span class="hljs-string">'write'</span> + suffix] =
    Buffer.prototype[<span class="hljs-string">'write'</span> + suffix].call;
  
  [<span class="hljs-string">'16'</span>, <span class="hljs-string">'32'</span>].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">size</span>) </span>{
    [<span class="hljs-string">'LE'</span>, <span class="hljs-string">'BE'</span>].forEach(<span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">endian</span>) </span>{
      <span class="hljs-keyword">var</span> suffix = sign + size + endian;
      <span class="hljs-keyword">var</span> read = Buffer.prototype[<span class="hljs-string">'read'</span> + suffix];
      <span class="hljs-built_in">module</span>.exports[<span class="hljs-string">'read'</span> + suffix] =
        <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">buf, offset, noAssert</span>) </span>{
          <span class="hljs-keyword">return</span> read.call(buf, offset, noAssert);
        };
      <span class="hljs-keyword">var</span> write = Buffer.prototype[<span class="hljs-string">'write'</span> + suffix];
      <span class="hljs-built_in">module</span>.exports[<span class="hljs-string">'write'</span> + suffix] =
        <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
          <span class="hljs-keyword">return</span> write.call(buf, val, offset, noAssert);
        };
    });
  });
});

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>Check that a value is an integer within the given range</p>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">check_int</span>(<span class="hljs-params">val, min, max</span>) </span>{
    assert.ok(<span class="hljs-keyword">typeof</span>(val) == <span class="hljs-string">'number'</span> &amp;&amp; val &gt;= min &amp;&amp; val &lt;= max &amp;&amp; <span class="hljs-built_in">Math</span>.floor(val) === val, <span class="hljs-string">"not a number in the required range"</span>);
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt24BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
  <span class="hljs-keyword">return</span> buf.readUInt8(offset, noAssert) &lt;&lt; <span class="hljs-number">16</span> | buf.readUInt16BE(offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt24BE = readUInt24BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt24BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffff</span>);
        assert.ok(offset + <span class="hljs-number">3</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeUInt8(val &gt;&gt;&gt; <span class="hljs-number">16</span>, offset, noAssert);
    buf.writeUInt16BE(val &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt24BE = writeUInt24BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt40BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readUInt8(offset, noAssert) || <span class="hljs-number">0</span>) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt40BE = readUInt40BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt40BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">5</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeUInt8(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
    buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt40BE = writeUInt40BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt48BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readUInt16BE(offset, noAssert) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt48BE = readUInt48BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt48BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">6</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeUInt16BE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
    buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt48BE = writeUInt48BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt56BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> ((buf.readUInt8(offset, noAssert) || <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">16</span> | buf.readUInt16BE(offset + <span class="hljs-number">1</span>, noAssert)) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">3</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt56BE = readUInt56BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt56BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">7</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x100000000000000</span>) {
        <span class="hljs-keyword">var</span> hi = <span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32);
        buf.writeUInt8(hi &gt;&gt;&gt; <span class="hljs-number">16</span>, offset, noAssert);
        buf.writeUInt16BE(hi &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">1</span>, noAssert);
        buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">3</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>Special case because 2^56-1 gets rounded up to 2^56</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeUInt56BE = writeUInt56BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt64BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readUInt32BE(offset, noAssert) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt64BE = readUInt64BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt64BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">8</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x10000000000000000</span>) {
        buf.writeUInt32BE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
        buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">4</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>Special case because 2^64-1 gets rounded up to 2^64</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">7</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeUInt64BE = writeUInt64BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt24LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readUInt8(offset + <span class="hljs-number">2</span>, noAssert) &lt;&lt; <span class="hljs-number">16</span> | buf.readUInt16LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt24LE = readUInt24LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt24LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffff</span>);
        assert.ok(offset + <span class="hljs-number">3</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeUInt16LE(val &amp; <span class="hljs-number">0xffff</span>, offset, noAssert);
    buf.writeUInt8(val &gt;&gt;&gt; <span class="hljs-number">16</span>, offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt24LE = writeUInt24LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt40LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readUInt8(offset + <span class="hljs-number">4</span>, noAssert) || <span class="hljs-number">0</span>) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt40LE = readUInt40LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt40LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">5</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
    buf.writeUInt8(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt40LE = writeUInt40LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt48LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readUInt16LE(offset + <span class="hljs-number">4</span>, noAssert) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt48LE = readUInt48LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt48LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">6</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
    buf.writeUInt16LE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeUInt48LE = writeUInt48LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt56LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> ((buf.readUInt8(offset + <span class="hljs-number">6</span>, noAssert) || <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">16</span> | buf.readUInt16LE(offset + <span class="hljs-number">4</span>, noAssert)) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt56LE = readUInt56LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt56LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">7</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x100000000000000</span>) {
        buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
        <span class="hljs-keyword">var</span> hi = <span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32);
        buf.writeUInt16LE(hi &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">4</span>, noAssert);
        buf.writeUInt8(hi &gt;&gt;&gt; <span class="hljs-number">16</span>, offset + <span class="hljs-number">6</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Special case because 2^56-1 gets rounded up to 2^56</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeUInt56LE = writeUInt56LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readUInt64LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readUInt32LE(offset + <span class="hljs-number">4</span>, noAssert) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readUInt64LE = readUInt64LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeUInt64LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">0</span>, <span class="hljs-number">0xffffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">8</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x10000000000000000</span>) {
        buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
        buf.writeUInt32LE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<p>Special case because 2^64-1 gets rounded up to 2^64</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">7</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeUInt64LE = writeUInt64LE;


<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt24BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readInt8(offset, noAssert) &lt;&lt; <span class="hljs-number">16</span>) + buf.readUInt16BE(offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt24BE = readInt24BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt24BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000</span>, <span class="hljs-number">0x7fffff</span>);
        assert.ok(offset + <span class="hljs-number">3</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt8(val &gt;&gt; <span class="hljs-number">16</span>, offset, noAssert);
    buf.writeUInt16BE(val &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt24BE = writeInt24BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt40BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readInt8(offset, noAssert) || <span class="hljs-number">0</span>) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt40BE = readInt40BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt40BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x8000000000</span>, <span class="hljs-number">0x7fffffffff</span>);
        assert.ok(offset + <span class="hljs-number">5</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt8(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
    buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">1</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt40BE = writeInt40BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt48BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readInt16BE(offset, noAssert) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt48BE = readInt48BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt48BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000000000</span>, <span class="hljs-number">0x7fffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">6</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt16BE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
    buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt48BE = writeInt48BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt56BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (((buf.readInt8(offset, noAssert) || <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">16</span>) + buf.readUInt16BE(offset + <span class="hljs-number">1</span>, noAssert)) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">3</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt56BE = readInt56BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt56BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000000000000</span>, <span class="hljs-number">0x7fffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">7</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x80000000000000</span>) {
        <span class="hljs-keyword">var</span> hi = <span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32);
        buf.writeInt8(hi &gt;&gt; <span class="hljs-number">16</span>, offset, noAssert);
        buf.writeUInt16BE(hi &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">1</span>, noAssert);
        buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">3</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<p>Special case because 2^55-1 gets rounded up to 2^55</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0x7f</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeInt56BE = writeInt56BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt64BE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readInt32BE(offset, noAssert) * SHIFT_LEFT_32 + buf.readUInt32BE(offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt64BE = readInt64BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt64BE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000000000000000</span>, <span class="hljs-number">0x7fffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">8</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x8000000000000000</span>) {
        buf.writeInt32BE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset, noAssert);
        buf.writeInt32BE(val &amp; <span class="hljs-number">-1</span>, offset + <span class="hljs-number">4</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<p>Special case because 2^63-1 gets rounded up to 2^63</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0x7f</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">7</span>] = <span class="hljs-number">0xff</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeInt64BE = writeInt64BE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt24LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readInt8(offset + <span class="hljs-number">2</span>, noAssert) &lt;&lt; <span class="hljs-number">16</span>) + buf.readUInt16LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt24LE = readInt24LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt24LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000</span>, <span class="hljs-number">0x7fffff</span>);
        assert.ok(offset + <span class="hljs-number">3</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeUInt16LE(val &amp; <span class="hljs-number">0xffff</span>, offset, noAssert);
    buf.writeInt8(val &gt;&gt; <span class="hljs-number">16</span>, offset + <span class="hljs-number">2</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt24LE = writeInt24LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt40LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (buf.readInt8(offset + <span class="hljs-number">4</span>, noAssert) || <span class="hljs-number">0</span>) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt40LE = readInt40LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt40LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x8000000000</span>, <span class="hljs-number">0x7fffffffff</span>);
        assert.ok(offset + <span class="hljs-number">5</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
    buf.writeInt8(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt40LE = writeInt40LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt48LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readInt16LE(offset + <span class="hljs-number">4</span>, noAssert) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt48LE = readInt48LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt48LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x800000000000</span>, <span class="hljs-number">0x7fffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">6</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
    buf.writeInt16LE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
}
<span class="hljs-built_in">module</span>.exports.writeInt48LE = writeInt48LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt56LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> (((buf.readInt8(offset + <span class="hljs-number">6</span>, noAssert) || <span class="hljs-number">0</span>) &lt;&lt; <span class="hljs-number">16</span>) + buf.readUInt16LE(offset + <span class="hljs-number">4</span>, noAssert)) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt56LE = readInt56LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt56LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x80000000000000</span>, <span class="hljs-number">0x7fffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">7</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x80000000000000</span>) {
        buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
        <span class="hljs-keyword">var</span> hi = <span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32);
        buf.writeUInt16LE(hi &amp; <span class="hljs-number">0xffff</span>, offset + <span class="hljs-number">4</span>, noAssert);
        buf.writeInt8(hi &gt;&gt; <span class="hljs-number">16</span>, offset + <span class="hljs-number">6</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<p>Special case because 2^55-1 gets rounded up to 2^55</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0x7f</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeInt56LE = writeInt56LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">readInt64LE</span>(<span class="hljs-params">buf, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">return</span> buf.readInt32LE(offset + <span class="hljs-number">4</span>, noAssert) * SHIFT_LEFT_32 + buf.readUInt32LE(offset, noAssert);
}
<span class="hljs-built_in">module</span>.exports.readInt64LE = readInt64LE;

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">writeInt64LE</span>(<span class="hljs-params">buf, val, offset, noAssert</span>) </span>{
    <span class="hljs-keyword">if</span> (!noAssert) {
        check_int(val, <span class="hljs-number">-0x8000000000000000</span>, <span class="hljs-number">0x7fffffffffffffff</span>);
        assert.ok(offset + <span class="hljs-number">8</span> &lt;= buf.length, <span class="hljs-string">"attempt to write beyond end of buffer"</span>);
    }

    <span class="hljs-keyword">if</span> (val &lt; <span class="hljs-number">0x8000000000000000</span>) {
        buf.writeInt32LE(val &amp; <span class="hljs-number">-1</span>, offset, noAssert);
        buf.writeInt32LE(<span class="hljs-built_in">Math</span>.floor(val * SHIFT_RIGHT_32), offset + <span class="hljs-number">4</span>, noAssert);
    } <span class="hljs-keyword">else</span> {
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<p>Special case because 2^55-1 gets rounded up to 2^55</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">        buf[offset] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">1</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">2</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">3</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">4</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">5</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">6</span>] = <span class="hljs-number">0xff</span>;
        buf[offset+<span class="hljs-number">7</span>] = <span class="hljs-number">0x7f</span>;
    }
}
<span class="hljs-built_in">module</span>.exports.writeInt64LE = writeInt64LE;

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
