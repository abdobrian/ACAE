<!DOCTYPE html>
<html>
<head>
  <title>index.js</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../../../doc-style.css" />
  <script src="../../../doc-filelist.js"></script>
  <script>
    var relativeDir = "../../../";
    var thisFile = "ClientApp\\node_modules\\combine-source-map\\index.js";
    var defaultSidebar = true;
  </script>
  <script src="../../../doc-script.js"></script>

</head>
<body>
  <div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">

    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container">
    <div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
    
      <tr>
        <td class="docs">
          <h1>index.js</h1>
        </td>
        <td class="code highlight"></td>
      </tr>
    
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-1" id="section-1"></a>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-meta">'use strict'</span>;

<span class="hljs-keyword">var</span> path            =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'path'</span>);
<span class="hljs-keyword">var</span> convert         =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'convert-source-map'</span>);
<span class="hljs-keyword">var</span> memoize         =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'lodash.memoize'</span>);
<span class="hljs-keyword">var</span> createGenerator =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'inline-source-map'</span>);
<span class="hljs-keyword">var</span> pathIsAbsolute  =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/path-is-absolute'</span>);
<span class="hljs-keyword">var</span> mappingsFromMap =  <span class="hljs-built_in">require</span>(<span class="hljs-string">'./lib/mappings-from-map'</span>);

<span class="hljs-keyword">var</span> protocolRx = <span class="hljs-regexp">/^[a-z]+:\/\//</span>;

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-2" id="section-2"></a>
</div>
<div class="dox">
<div class="summary">
<p>Rebases a relative path in 'sourceFile' to be relative
to the path where 'sourceFile' is located.</p>
</div>
<div class="body">
<p>This is necessary before adding relative paths to the
new combined map to ensure all paths are relative to their
original source.</p>
<p>The 'sourceRoot' from the original source map is joined
as well to ensure the complete path.</p>
<p>Resulting paths that are absolute are passed along directly.</p>
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">sourceFile</span>
<span>{String} path to the original source file that references a map
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">relativeRoot</span>
<span>{String} sourceRoot in sourceFile's map to combine with relativePath
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">relativePath</span>
<span>{String} source path from sourceFile's map
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript"><span class="hljs-keyword">var</span> rebaseRelativePath = memoize(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">sourceFile, relativeRoot, relativePath</span>) </span>{
  <span class="hljs-keyword">if</span> (!relativePath) {
    <span class="hljs-keyword">return</span> relativePath;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-3" id="section-3"></a>
</div>
<p>join relative path to root (e.g. 'src/' + 'file.js')</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">var</span> relativeRootedPath = relativeRoot ? path.join(relativeRoot, relativePath) : relativePath;
  relativeRootedPath = relativeRootedPath.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
  sourceFile = sourceFile.replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);

  <span class="hljs-keyword">if</span> (sourceFile === relativeRootedPath ||    <span class="hljs-comment">// same path,</span>
      pathIsAbsolute(relativeRootedPath) ||   <span class="hljs-comment">// absolute path, nor</span>
      protocolRx.test(relativeRootedPath)) {  <span class="hljs-comment">// absolute protocol need rebasing</span>
    <span class="hljs-keyword">return</span> relativeRootedPath;
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4"></a>
</div>
<p>make relative to source file</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">return</span> path.join(path.dirname(sourceFile), relativeRootedPath).replace(<span class="hljs-regexp">/\\/g</span>, <span class="hljs-string">'/'</span>);
}, <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">a, b, c</span>) </span>{
  <span class="hljs-keyword">return</span> a + <span class="hljs-string">'::'</span> + b + <span class="hljs-string">'::'</span> + c;
});

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">resolveMap</span>(<span class="hljs-params">source</span>) </span>{
  <span class="hljs-keyword">var</span> gen = convert.fromSource(source);
  <span class="hljs-keyword">return</span> gen ? gen.toObject() : <span class="hljs-literal">null</span>;
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">hasInlinedSource</span>(<span class="hljs-params">existingMap</span>) </span>{
  <span class="hljs-keyword">return</span> existingMap.sourcesContent &amp;&amp; !!existingMap.sourcesContent[<span class="hljs-number">0</span>];
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Combiner</span>(<span class="hljs-params">file, sourceRoot</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5"></a>
</div>
<p>since we include the original code in the map sourceRoot actually not needed</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">this</span>.generator = createGenerator({ <span class="hljs-attr">file</span>: file || <span class="hljs-string">'generated.js'</span>, <span class="hljs-attr">sourceRoot</span>: sourceRoot });
}

Combiner.prototype._addGeneratedMap = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sourceFile, source, offset</span>) </span>{
  <span class="hljs-keyword">this</span>.generator.addGeneratedMappings(sourceFile, source, offset);
  <span class="hljs-keyword">this</span>.generator.addSourceContent(sourceFile, source);
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

Combiner.prototype._addExistingMap = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">sourceFile, source, existingMap, offset</span>) </span>{
  <span class="hljs-keyword">var</span> mappings = mappingsFromMap(existingMap);

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6"></a>
</div>
<p>add all of the sources from the map</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  <span class="hljs-keyword">for</span> (<span class="hljs-keyword">var</span> i = <span class="hljs-number">0</span>, len = existingMap.sources.length; i &lt; len; i++) {
    <span class="hljs-keyword">if</span> (!existingMap.sourcesContent) <span class="hljs-keyword">continue</span>;

    <span class="hljs-keyword">this</span>.generator.addSourceContent(
      rebaseRelativePath(sourceFile, existingMap.sourceRoot, existingMap.sources[i]),
      existingMap.sourcesContent[i]);
  }

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-7" id="section-7"></a>
</div>
<p>add the mappings, preserving the original mapping 'source'</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">  mappings.forEach(<span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params">mapping</span>) </span>{
</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-8" id="section-8"></a>
</div>
<p>Add the mappings one at a time because 'inline-source-map' doesn't handle
mapping source filenames. The mapping.source already takes sourceRoot into account
per the SMConsumer.eachMapping function, so pass null for the root here.</p>

        </td>
        <td class="code highlight">
          <pre class="javascript">    <span class="hljs-keyword">this</span>.generator.addMappings(
      rebaseRelativePath(sourceFile, <span class="hljs-literal">null</span>, mapping.source), [mapping], offset);
  }, <span class="hljs-keyword">this</span>);

  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>;
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9"></a>
</div>
<div class="dox">
<div class="summary">
<p>Adds map to underlying source map.
If source contains a source map comment that has the source of the original file inlined it will offset these
mappings and include them.
If no source map comment is found or it has no source inlined, mappings for the file will be generated and included</p>
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">opts</span>
<span>{Object} { sourceFile: {String}, source: {String} }
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">offset</span>
<span>{Object} { line: {Number}, column: {Number} }
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Combiner.prototype.addFile = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">opts, offset</span>) </span>{

  offset = offset || {};
  <span class="hljs-keyword">if</span> (!offset.hasOwnProperty(<span class="hljs-string">'line'</span>))  offset.line    =  <span class="hljs-number">0</span>;
  <span class="hljs-keyword">if</span> (!offset.hasOwnProperty(<span class="hljs-string">'column'</span>)) offset.column =  <span class="hljs-number">0</span>;

  <span class="hljs-keyword">var</span> existingMap = resolveMap(opts.source);

  <span class="hljs-keyword">return</span> existingMap &amp;&amp; hasInlinedSource(existingMap)
    ? <span class="hljs-keyword">this</span>._addExistingMap(opts.sourceFile, opts.source, existingMap, offset)
    : <span class="hljs-keyword">this</span>._addGeneratedMap(opts.sourceFile, opts.source, offset);
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">String</span>
<span>base64 encoded combined source map
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Combiner.prototype.base64 = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.generator.base64Encode();
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">String</span>
<span>base64 encoded sourceMappingUrl comment of the combined source map
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">Combiner.prototype.comment = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.generator.inlineMappingUrl();
};

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">file</span>
<span>{String} optional name of the generated file
</span>
</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">sourceRoot</span>
<span>{String} optional sourceRoot of the map to be generated
</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">Object</span>
<span>Combiner instance to which source maps can be added and later combined
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">exports.create = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">file, sourceRoot</span>) </span>{ <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Combiner(file, sourceRoot); };

</pre>
        </td>
      </tr>
    
      <tr>
        <td class="docs">
          <div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13"></a>
</div>
<div class="dox">
<div class="summary">
</div>
<div class="body">
</div>
<div class="details">
<div class="dox_tag_title">Params</div>
<div class="dox_tag_detail">
<span class="dox_tag_name">src</span>
</div>
<div class="dox_tag_title">Returns</div>
<div class="dox_tag_detail">
<span class="dox_tag_name"></span>
<span class="dox_type">String</span>
<span>src with all sourceMappingUrl comments removed
</span>
</div>
</div>
</div>

        </td>
        <td class="code highlight">
          <pre class="javascript">exports.removeComments = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">src</span>) </span>{
  <span class="hljs-keyword">if</span> (!src.replace) <span class="hljs-keyword">return</span> src;
  <span class="hljs-keyword">return</span> src.replace(convert.commentRegex, <span class="hljs-string">''</span>).replace(convert.mapFileCommentRegex, <span class="hljs-string">''</span>);
};

</pre>
        </td>
      </tr>
    
  </tbody>
</table>

  </div>
</body>
</html>
